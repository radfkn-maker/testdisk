# Bitcoin Wallet Signatures for PhotoRec - Final Version
# True file format headers (â‰¥8 bytes) + Critical 4-byte Berkeley DB magic numbers
# Each signature type includes both HEX and ASCII versions where applicable
# Format: extension offset signature
#

# ========== BERKELEY DB (Bitcoin Core wallet.dat) ==========

# Berkeley DB 4-byte magic numbers (CRITICAL - all 8 variants)
dat 0 0x61, 0x15, 0x06, 0x00
dat 0 0x00, 0x06, 0x15, 0x61
dat 0 0x62, 0x31, 0x05, 0x00
dat 0 0x00, 0x05, 0x31, 0x62
dat 0 0x53, 0x22, 0x04, 0x00
dat 0 0x00, 0x04, 0x22, 0x53
dat 0 0x88, 0x09, 0x04, 0x00
dat 0 0x00, 0x04, 0x09, 0x88

# Berkeley DB extended signature with header structure - 24 bytes at offset 8
dat 8 0x00, 0x00, 0x00, 0x00, 0x62, 0x31, 0x05, 0x00, 0x09, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00

# Additional Berkeley DB variants
dat 0 0x00, 0x04, 0x05, 0x71
dat 0 0x00, 0x06, 0x31, 0x62
dat 0 0x62, 0x31, 0x06, 0x00
dat 0 0x71, 0x05, 0x04, 0x00

# ========== BITCOIN CORE WALLET.DAT SIGNATURES ==========

# Bitcoin Core 2013+ encrypted wallet mkey signature - 23 bytes (CRITICAL)
# HEX: Universal fingerprint for ALL encrypted wallets from v0.8.0 onwards
dat 0 0x04, 0x20, 0xC2, 0x5F, 0x3B, 0xB2, 0xD3, 0x75, 0x24, 0x47, 0x96, 0xF8, 0x22, 0xAC, 0xDD, 0xB7, 0x3F, 0x53, 0xD0, 0x24, 0x09, 0x8E, 0xED

# Bitcoin Core unencrypted bestpkey signature - 10 bytes
# ========== BITCOIN CORE (wallet.dat) ADDITIONS ==========
# name"1 entry (Address Book prefix) - ASCII escaped
dat 0 "name\"1"
# name"1 entry - HEX version (6e 61 6d 65 22 31)
dat 0 0x6e, 0x61, 0x6d, 0x65, 0x22, 0x31
# BerkeleyDB binary markers
dat 0 0x04, "key"
dat 0 "key", 0x00
dat 0 "ckey"
dat 0 "mkey"
dat 0 "bestblock"

# ========== ELECTRUM & JSON WALLET KEYWORDS ==========
wallet 0 "keystore"
wallet 0 "keypairs"
wallet 0 "seed_version"
wallet 0 "imported"
wallet 0 "seed"
wallet 0 "master_public_key"
wallet 0 "wallet_type"

# ========== BIP32 / HD WALLET MARKERS ==========
wallet 0 "xprv"
wallet 0 "xpub"

# ========== GENERIC PRIVATE KEY MARKERS ==========
key 0 "privkey"
key 0 "priv_key"
key 0 "private_key"
key 0 "priv"
key 0 "addr"
key 0 "wallet"
key 0 "master"
key 0 "reserve"

# HEX: Appears exactly once in every unencrypted Bitcoin Core wallet
dat 0 0x04, 0x06, 0x62, 0x65, 0x73, 0x74, 0x70, 0x6B, 0x65, 0x79
# ASCII: (bestpkey with length prefix)
dat 0 0x04, 0x06, "bestpkey"

# Bitcoin Core defaultkey record - 11 bytes
# HEX:
dat 0 0x04, 0x64, 0x65, 0x66, 0x61, 0x75, 0x6C, 0x74, 0x6B, 0x65, 0x79
# ASCII: (defaultkey with length prefix)
dat 0 0x04, "defaultkey"

# Bitcoin Core record markers
# HEX:
dat 0 0x07, 0x61, 0x63, 0x65, 0x6E, 0x74, 0x72, 0x79
dat 0 0x07, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E
dat 0 0x0A, 0x6D, 0x69, 0x6E, 0x76, 0x65, 0x72, 0x73, 0x69, 0x6F, 0x6E
dat 0 0x0A, 0x07, 0x62, 0x65, 0x73, 0x74, 0x62, 0x6C, 0x6F, 0x63, 0x6B
# ASCII:
dat 0 0x07, "acentry"
dat 0 0x07, "version"
dat 0 0x0A, "minversion"

# ========== ARMORY WALLET SIGNATURES ==========

# Armory encrypted root key - 8 bytes
# HEX:
wallet 0 0x41, 0x52, 0x47, 0x59, 0x2D, 0x65, 0x6E, 0x63
# ASCII:
wallet 0 "ARGY-enc"

# Armory root key identifier - 9 bytes
# HEX:
wallet 0 0x41, 0x52, 0x47, 0x59, 0x2D, 0x72, 0x6F, 0x6F, 0x74
# ASCII:
wallet 0 "ARGY-root"

# Armory watchonly marker - 9 bytes
# HEX:
wallet 0 0x77, 0x61, 0x74, 0x63, 0x68, 0x6F, 0x6E, 0x6C, 0x79
# ASCII:
wallet 0 "watchonly"

# Armory wallet magic - 7 bytes
# HEX:
wallet 0 0xBA, 0x57, 0x41, 0x4C, 0x4C, 0x45, 0x00

# Armory WALLET magic (full) - 7 bytes
# HEX:
wallet 0 0xBA, 0x57, 0x41, 0x4C, 0x4C, 0x45, 0x54

# ========== MULTIBIT WALLET SIGNATURES ==========

# MultiBit protobuf production marker - 23 bytes
# HEX:
wallet 0 0x0A, 0x16, 0x6F, 0x72, 0x67, 0x2E, 0x62, 0x69, 0x74, 0x63, 0x6F, 0x69, 0x6E, 0x2E, 0x70, 0x72, 0x6F, 0x64, 0x75, 0x63, 0x74, 0x69, 0x6F, 0x6E
# ASCII:
wallet 0 0x0A, 0x16, "org.bitcoin.production"

# MultiBit header - 9 bytes
# HEX:
wallet 0 0x4D, 0x55, 0x4C, 0x54, 0x49, 0x42, 0x49, 0x54, 0x20
# ASCII:
wallet 0 "MULTIBIT "

# MultiBit header - 8 bytes
# HEX:
wallet 0 0x4D, 0x55, 0x4C, 0x54, 0x41, 0x42, 0x49, 0x54
# ASCII:
wallet 0 "MULTABIT"

# ========== ELECTRUM WALLET SIGNATURES ==========

# Electrum v1 addr_history magic (single quotes) - 16 bytes
# HEX:
wallet 0 0x7B, 0x27, 0x61, 0x64, 0x64, 0x72, 0x5F, 0x68, 0x69, 0x73, 0x74, 0x6F, 0x72, 0x79, 0x27, 0x3A
# ASCII:
wallet 0 "{'addr_history':"

# Electrum v1 addr_history pretty-printed - 21 bytes
# HEX:
wallet 0 0x7B, 0x0A, 0x20, 0x20, 0x20, 0x20, 0x27, 0x61, 0x64, 0x64, 0x72, 0x5F, 0x68, 0x69, 0x73, 0x74, 0x6F, 0x72, 0x79, 0x27, 0x3A

# Electrum v1 JSON {"addr_history": (double quotes) - 16 bytes
# HEX:
wallet 0 0x7B, 0x22, 0x61, 0x64, 0x64, 0x72, 0x5F, 0x68, 0x69, 0x73, 0x74, 0x6F, 0x72, 0x79, 0x22, 0x3A
# ASCII:
wallet 0 "{\"addr_history\":"

# Electrum v1 JSON {"seed": - 8 bytes
# HEX:
wallet 0 0x7B, 0x22, 0x73, 0x65, 0x65, 0x64, 0x22, 0x3A
# ASCII:
wallet 0 "{\"seed\":"

# Electrum v1 JSON {"keystore": - 12 bytes
# HEX:
wallet 0 0x7B, 0x22, 0x6B, 0x65, 0x79, 0x73, 0x74, 0x6F, 0x72, 0x65, 0x22, 0x3A
# ASCII:
wallet 0 "{\"keystore\":"

# ========== BLOCKCHAIN.INFO WALLET SIGNATURES ==========

# Blockchain.info domain identifier - 15 bytes
# HEX:
json 0 0x62, 0x6C, 0x6F, 0x63, 0x6B, 0x63, 0x68, 0x61, 0x69, 0x6E, 0x2E, 0x69, 0x6E, 0x66, 0x6F
# ASCII:
json 0 "blockchain.info"

# Blockchain.info JSON {"guid": - 8 bytes
# HEX:
json 0 0x7B, 0x22, 0x67, 0x75, 0x69, 0x64, 0x22, 0x3A
# ASCII:
json 0 "{\"guid\":"

# Blockchain.info JSON {"payload": - 11 bytes
# HEX:
json 0 0x7B, 0x22, 0x70, 0x61, 0x79, 0x6C, 0x6F, 0x61, 0x64, 0x22, 0x3A
# ASCII:
json 0 "{\"payload\":"

# ========== GENERIC ENCRYPTION & KEY FORMATS ==========

# SQLite format header - 16 bytes
# HEX:
db 0 "SQLite format 3", 0x00

# OpenSSL Salted__ - 8 bytes
# HEX:
key 0 0x53, 0x61, 0x6C, 0x74, 0x65, 0x64, 0x5F, 0x5F
# ASCII:
key 0 "Salted__"

# PGP armored - 15 bytes
# ASCII:
pgp 0 "-----BEGIN PGP"

# BEGIN EC PRIVATE KEY - 19 bytes
# ASCII:
key 0 "BEGIN EC PRIVATE KEY"

# BEGIN PRIVATE KEY - 18 bytes
# HEX:
key 0 0x42, 0x45, 0x47, 0x49, 0x4E, 0x20, 0x50, 0x52, 0x49, 0x56, 0x41, 0x54, 0x45, 0x20, 0x4B, 0x45, 0x59
# ASCII:
key 0 "BEGIN PRIVATE KEY"

# ========== PHOTOREC-SPECIFIC BITCOIN MARKERS ==========

# PhotoRec U2FsdGVkX1 (OpenSSL "Salted__" in base64) - 10 bytes
# HEX:
dat 0 0x55, 0x32, 0x46, 0x73, 0x64, 0x47, 0x56, 0x6B, 0x58, 0x31
# ASCII:
dat 0 "U2FsdGVkX1"

# PhotoRec com.google.bitcoin.core - 23 bytes (offset 8)
# HEX:
dat 8 0x63, 0x6F, 0x6D, 0x2E, 0x67, 0x6F, 0x6F, 0x67, 0x6C, 0x65, 0x2E, 0x62, 0x69, 0x74, 0x63, 0x6F, 0x69, 0x6E, 0x2E, 0x63, 0x6F, 0x72, 0x65
# ASCII:
dat 8 "com.google.bitcoin.core"

# PhotoRec warning comment - 32 bytes
# HEX:
dat 0 0x23, 0x20, 0x4B, 0x45, 0x45, 0x50, 0x20, 0x59, 0x4F, 0x55, 0x52, 0x20, 0x50, 0x52, 0x49, 0x56, 0x41, 0x54, 0x45, 0x20, 0x4B, 0x45, 0x59, 0x53, 0x20, 0x53, 0x41, 0x46, 0x45, 0x20, 0x21
# ASCII:
dat 0 "# KEEP YOUR PRIVATE KEYS SAFE !"
